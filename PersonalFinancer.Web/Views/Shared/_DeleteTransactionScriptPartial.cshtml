<script>
	document.getElementById('tableBody').addEventListener('click', async (e) => {
		if (e.target.tagName == 'BUTTON') {
			if (confirm('Are you sure you want to delete this Transaction?')) {
				let transactionId = e.target.id;

				let response = await fetch(
					'@ApiTransactionsUrl' + transactionId,
					{ method: 'DELETE' }
				);

				if (response.status == 204) {
					let transactionRow = e.target.parentElement.parentElement;
					document.getElementById('tableBody').removeChild(transactionRow);

					let transactionAmount = transactionRow.children[3].textContent;
					let transactionType = transactionRow.children[2].textContent;
					let newBalance;

					if (transactionType == 'Income') {
						newBalance = @Model.Balance - Number(transactionAmount);
					} else {
						newBalance = @Model.Balance + Number(transactionAmount);
					}

					document.getElementById('balanceField').textContent = `Balance: ${newBalance.toFixed(2)} @(Model.CurrencyName)`;
				} else {
					alert('Somethink happened!');
				}
			}
		}
	})
</script>
